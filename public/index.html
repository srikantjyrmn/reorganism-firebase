<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reorganism.in - AI Agency</title>
  <style>
    body,
    html {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: Arial, sans-serif;
      overflow: hidden;
      background-color: #000;
    }

    #matrix-background {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }

    #content {
      position: relative;
      z-index: 1;
      color: white;
      text-align: center;
      padding-top: 20vh;
    }

    #logo {
      font-size: 4em;
      animation: float 3s ease-in-out infinite;
    }

    @keyframes float {
      0% {
        transform: translateY(0px);
      }

      50% {
        transform: translateY(-20px);
      }

      100% {
        transform: translateY(0px);
      }
    }

    nav {
      margin-top: 2em;
    }

    nav a {
      color: white;
      text-decoration: none;
      margin: 0 1em;
      font-size: 1.2em;
    }

    #chat-box {
      margin-top: 2em;
    }

    #chat-input {
      padding: 10px;
      width: 300px;
      border: none;
      border-radius: 5px 0 0 5px;
    }

    #chat-button {
      padding: 10px 20px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 0 5px 5px 0;
      cursor: pointer;
    }

    #chat-window {
      display: none;
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 300px;
      height: 400px;
      background-color: rgba(0, 0, 0, 0.8);
      border: 1px solid #0f0;
      border-radius: 10px;
      overflow: hidden;
      flex-direction: column;
    }

    #chat-messages {
      flex-grow: 1;
      overflow-y: auto;
      padding: 10px;
      color: #0f0;
    }

    #chat-input-area {
      display: flex;
      padding: 10px;
      background-color: rgba(0, 0, 0, 0.5);
    }

    #chat-input-area input {
      flex-grow: 1;
      padding: 5px;
      border: 1px solid #0f0;
      border-radius: 3px;
      background-color: black;
      color: #0f0;
    }

    #chat-input-area button {
      margin-left: 5px;
      padding: 5px 10px;
      background-color: #0f0;
      color: black;
      border: none;
      border-radius: 3px;
      cursor: pointer;
    }
  </style>
</head>

<body>
  <canvas id="matrix-background"></canvas>
  <div id="content">
    <h1 id="logo">reorganism.in</h1>
    <nav>
      <a href="#about">About</a>
      <a href="#coming-soon">Coming Soon</a>
    </nav>
    <div id="chat-box">
      <input type="text" id="chat-input" placeholder="Enter your message...">
      <button id="chat-button">Chat</button>
    </div>
  </div>

  <div id="chat-window">
    <div id="chat-messages"></div>
    <div id="chat-input-area">
      <input type="text" id="chat-window-input" placeholder="Type a message...">
      <button id="chat-window-send">Send</button>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-analytics-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-functions-compat.js"></script>
  <script src="firebase-config.js"></script>

  <script>
    // Matrix background
    const canvas = document.getElementById('matrix-background');
    const ctx = canvas.getContext('2d');

    canvas.height = window.innerHeight;
    canvas.width = window.innerWidth;

    const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789@#$%^&*()_+-=[]{}|;:,.<>?';
    const fontSize = 14;
    const columns = canvas.width / fontSize;

    const drops = [];
    for (let i = 0; i < columns; i++) {
      drops[i] = 1;
    }

    function drawMatrix() {
      ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      ctx.fillStyle = '#0f0';
      ctx.font = fontSize + 'px monospace';

      for (let i = 0; i < drops.length; i++) {
        const text = characters.charAt(Math.floor(Math.random() * characters.length));
        ctx.fillText(text, i * fontSize, drops[i] * fontSize);

        if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
          drops[i] = 0;
        }
        drops[i]++;
      }
    }

    setInterval(drawMatrix, 33);

    window.addEventListener('resize', () => {
      canvas.height = window.innerHeight;
      canvas.width = window.innerWidth;
    });

    // Chat functionality
    const chatButton = document.getElementById('chat-button');
    const chatInput = document.getElementById('chat-input');
    const chatWindow = document.getElementById('chat-window');
    const chatMessages = document.getElementById('chat-messages');
    const chatWindowInput = document.getElementById('chat-window-input');
    const chatWindowSend = document.getElementById('chat-window-send');

    async function sendMessageToFunction(message) {
      try {
        const chatFunction = firebase.functions().httpsCallable('chat');
        const result = await chatFunction({ message: message });
        return result.data.result;
      } catch (error) {
        console.error("Error calling Firebase function:", error);
        return "Sorry, there was an error processing your message.";
      }
    }

    async function openChat() {
      const initialMessage = chatInput.value.trim();
      if (initialMessage) {
        chatWindow.style.display = 'flex';
        addMessage(initialMessage, true);
        chatInput.value = '';
        const response = await sendMessageToFunction(initialMessage);
        addMessage(response);
      }
    }

    function addMessage(message, isUser = false) {
      const messageElement = document.createElement('div');
      messageElement.textContent = message;
      messageElement.style.marginBottom = '10px';
      messageElement.style.textAlign = isUser ? 'right' : 'left';
      messageElement.style.color = isUser ? '#0ff' : '#0f0';
      chatMessages.appendChild(messageElement);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    async function handleUserInput() {
      const message = chatWindowInput.value.trim();
      if (message) {
        addMessage(message, true);
        chatWindowInput.value = '';
        const response = await sendMessageToFunction(message);
        addMessage(response);
      }
    }

    chatButton.addEventListener('click', openChat);
    chatInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        openChat();
      }
    });
    chatWindowSend.addEventListener('click', handleUserInput);
    chatWindowInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        handleUserInput();
      }
    });

    // Firebase initialization
    document.addEventListener('DOMContentLoaded', (event) => {
      if (typeof firebaseConfig === 'undefined') {
        console.error('Firebase configuration is not defined. Please check your firebase-config.js file.');
        return;
      }

      try {
        firebase.initializeApp(firebaseConfig);

        if (firebase.analytics && firebase.analytics.isSupported()) {
          firebase.analytics();
          console.log('Firebase Analytics initialized successfully.');
        } else {
          console.log('Firebase Analytics is not supported in this environment.');
        }

        console.log('Firebase initialized successfully.');
      } catch (error) {
        console.error('Error initializing Firebase:', error);
      }
    });
  </script>
</body>

</html>